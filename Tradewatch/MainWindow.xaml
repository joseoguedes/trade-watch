<Window x:Class="Tradewatch.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Tradewatch" Height="500" Width="700" Background="#111111" Loaded="Window_Loaded">
    
    <Grid Background="Black">
        
        <Grid.Resources>
            <Style x:Key="TopLevelMenuItemStyle" TargetType="{x:Type MenuItem}">
                    <Setter Property="OverridesDefaultStyle" Value="True"/>
                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Padding" Value="10,4"/>
                    <Setter Property="Margin" Value="6,0"/>
                    <Setter Property="Cursor" Value="Hand"/>
                    
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="MenuItem">
                                <Grid SnapsToDevicePixels="True"> 
                                    <Border x:Name="TopBorder" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">   
                                        <ContentPresenter ContentSource="Header" RecognizesAccessKey="True" VerticalAlignment="Center" HorizontalAlignment="Center"/>                   
                                    </Border>
                                    
                                    <Popup x:Name="PART_Popup" Placement="Bottom" AllowsTransparency="True" Focusable="False" StaysOpen="False" IsOpen="{TemplateBinding IsSubmenuOpen}">
                                        <Border Background="#0A2F2C"
                                                BorderBrush="#156E68"
                                                BorderThickness="1"
                                                CornerRadius="2"
                                                Padding="2">
                                            
                                            <StackPanel IsItemsHost="True"/>
                                        </Border>
                                    </Popup>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsHighlighted" Value="True">
                                        <Setter TargetName="TopBorder" Property="Background" Value="#0E3F3B"/>
                                    </Trigger>
                                    <Trigger Property="IsSubmenuOpen" Value="True">
                                        <Setter TargetName="TopBorder" Property="Background" Value="#156E68"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

                <Style x:Key="SubMenuItemStyle" TargetType="{x:Type MenuItem}">
                    <Setter Property="OverridesDefaultStyle" Value="True"/>
                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                    <Setter Property="Background" Value="#0A2F2C"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderBrush" Value="#0E4E4A"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Padding" Value="6,4"/>
                    <Setter Property="Margin" Value="1"/>
                    
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="MenuItem">
                                <Grid SnapsToDevicePixels="True">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Border x:Name="ItemBorder"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="2"
                                            Padding="6,4,13,4"
                                            Grid.ColumnSpan="2">
                                        <ContentPresenter
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Margin="4,0"
                                            RecognizesAccessKey="True"
                                            ContentSource="Header"/>
                                    </Border>
                                            
                                    <Path x:Name="Arrow"
                                        Grid.Column="1"   
                                        Width="6"
                                        Height="10"
                                        Stretch="Fill"
                                        VerticalAlignment="Center"
                                        Margin="10,0,5,0"
                                        Fill="{TemplateBinding Foreground}"
                                        Data="M 0 0 L 6 5 L 0 10 Z"
                                        Visibility="Collapsed"/>
                                    
                                    <Popup x:Name="PART_Popup"
                                           Placement="Right" 
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           StaysOpen="False"
                                           IsOpen="{TemplateBinding IsSubmenuOpen}">
                                        
                                        <Border Background="#0A2F2C"
                                                BorderBrush="#156E68"
                                                BorderThickness="1"
                                                CornerRadius="2"
                                                Padding="2">

                                            <StackPanel IsItemsHost="True"/>
                                        </Border>
                                    </Popup>
                                </Grid>

                                <ControlTemplate.Triggers>
                                    <Trigger Property="HasItems" Value="True">
                                        <Setter TargetName="Arrow" Property="Visibility" Value="Visible"/>
                                    </Trigger>
                                    <Trigger Property="IsHighlighted" Value="True">
                                        <Setter TargetName="ItemBorder" Property="Background" Value="#114843"/>
                                        <Setter TargetName="ItemBorder" Property="BorderBrush" Value="#156E68"/>
                                    </Trigger>
                                    <Trigger Property="IsSubmenuOpen" Value="True">
                                        <Setter TargetName="ItemBorder" Property="Background" Value="#114843"/>
                                        <Setter TargetName="ItemBorder" Property="BorderBrush" Value="#156E68"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
                <Style TargetType="{x:Type Popup}">
                    <Setter Property="PopupAnimation" Value="Fade"/>
                </Style>
            </Grid.Resources>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Menu bar -->
            <RowDefinition Height="Auto"/>   <!-- Top bar -->
            <RowDefinition Height="*"/>      <!-- Main content -->
        </Grid.RowDefinitions>

         <!-- 🧭 Menu bar -->
         <!-- dark viridian green -->
        <Menu Grid.Row="0"
              Background="#0E4E4A" 
              Foreground="White"
              FontSize="14"
              FontWeight="SemiBold"
              Padding="5,2"
              ItemContainerStyle="{StaticResource TopLevelMenuItemStyle}">

            <MenuItem Header="_File" ItemContainerStyle="{StaticResource SubMenuItemStyle}">
                <MenuItem Header="E_xit" Click="ExitMenuItem_Click"/>
            </MenuItem>

            <MenuItem Header="_Help" ItemContainerStyle="{StaticResource SubMenuItemStyle}">
                <MenuItem Header="_About" Click="AboutMenuItem_Click"/>
            </MenuItem>
                
            <MenuItem Header="_Settings" ItemContainerStyle="{StaticResource SubMenuItemStyle}">
                <MenuItem Header="_Theme" ItemContainerStyle="{StaticResource SubMenuItemStyle}">
                    <MenuItem Header="Dark" Click="DarkTheme_Click"/>
                    <MenuItem Header="Light" Click="LightTheme_Click"/>
                </MenuItem>
                <MenuItem Header="Exchange Pool" Click="ManageExchanges_Click" />
            </MenuItem>
        </Menu>

    <!-- Top section: Local time -->
    <StackPanel Grid.Row="1" 
                Orientation="Horizontal" 
                Margin="15,10,0,10"> 
        <TextBlock Text="Local time: " 
                   Foreground="White"
                   FontSize="18"/>
        <TextBlock x:Name="LocalTimeText"
                   Foreground="White"
                   FontSize="18"
                   FontWeight="Bold"/>
    </StackPanel>

    <!-- Main data grid -->
        <DataGrid x:Name="ExchangeGrid"
                  Grid.Row="2"
                  AutoGenerateColumns="False"
                  Background="Black"
                  Foreground="White"
                  BorderBrush="Gray"
                  FontSize="14"
                  Margin="10"
                  IsReadOnly="True" 
                  HeadersVisibility="Column">

            <DataGrid.Columns>
                <DataGridTextColumn Header="Exchange" Binding="{Binding Name}" Width="*"/>
                <DataGridTemplateColumn Header="Status" Width="130">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Ellipse Width="12" Height="12" Fill="{Binding StatusColor}" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding StatusText}" Foreground="White" FontWeight="Bold"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="Local Time" Binding="{Binding LocalTime}" Width="100"/>
                <DataGridTextColumn Header="Open Hours" Binding="{Binding OpenCloseHours}" Width="120"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window>